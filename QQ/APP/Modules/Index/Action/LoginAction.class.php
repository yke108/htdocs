<?phpClass LoginAction extends Action {	Public function index () {		$user_name = isset($_COOKIE['user_name']) ? $_COOKIE['user_name'] : '';		$password = isset($_COOKIE['password']) ? $_COOKIE['password'] : '';		$this->assign('user_name',$user_name);		$this->assign('password',$password);		$this->display();	}	Public function runLogin () {		$user_name = isset($_POST['user_name']) ? $_POST['user_name'] : (isset($_COOKIE['user_name']) ? $_COOKIE['user_name'] : '');		$password = isset($_POST['password']) ? $_POST['password'] : (isset($_COOKIE['password']) ? $_COOKIE['password'] : '');		$remember = isset($_POST['remember']) ? $_POST['remember'] : 0;		$user = M('user')->WHERE(array('user_name'=>$user_name,'password'=>md5($password)))->find();		if($user){			if($remember){				setcookie('user_name',$user_name);				setcookie('password',$password);			}else{				setcookie("user_name", "", time() - 3600);				setcookie("password", "", time() - 3600);			}			session('user_id',$user['user_id']);			session('user_name',$user['user_name']);			$this->success('登录成功',U(GROUP_NAME.'/Index/index'));		}else{			$this->error('帐号或者密码不正确');		}	}	Public function logout(){		$user = M('user')->WHERE(array('user_id'=>$_SESSION['user_id']))->setField('logout_time',time());		session_unset();		session_destroy();		$this->redirect(GROUP_NAME.'/Login/index');	}		Public function qq_login(){		require_once("./Class/Connect2.0/API/qqConnectAPI.php");		$qc = new QC();		$qc->qq_login();	}	Public function callback(){		require_once("./Class/Connect2.0/API/qqConnectAPI.php");		$qc = new QC();		$acs = $qc->qq_callback();		$oid = $qc->get_openid();		$qc = new QC($acs,$oid);		$uinfo = $qc->get_user_info();		$user = M('User')->where('qq_openid="'.$oid.'"')->find();		if($user){			session('user_id',$user['user_id']);			session('user_name',$user['user_name']);			M('User')->where('user_id='.$user['user_id'])->save(array('login_time'=>time()));		}else{			//$filename = getImage($uinfo['figureurl_qq_1'],'');			$data = array(				'user_name' => $uinfo['nickname'],				'password' => md5($acs),				'qq_openid'=> $oid,				'login_time' => time(),				'logo' => $uinfo['figureurl_qq_1'],				);			$user_id = M('User')->data($data)->add();			session('user_id',$user_id);			session('user_name',$uinfo['nickname']);		}		$this->success('登录成功',U(GROUP_NAME.'/Index/index'));	}}?>